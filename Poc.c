/*
*
* Copyright (c) 2015-2017 by blindtiger ( blindtiger@foxmail.com )
*
* The contents of this file are subject to the Mozilla Public License Version
* 2.0 (the "License"); you may not use this file except in compliance with
* the License. You may obtain a copy of the License at
* http://www.mozilla.org/MPL/
*
* Software distributed under the License is distributed on an "AS IS" basis,
* WITHOUT WARRANTY OF ANY KIND, either express or implied. SEe the License
* for the specific language governing rights and limitations under the
* License.
*
* The Initial Developer of the Original e is blindtiger.
*
*/

#include "Poc.h"
#include "Scan.h"

VOID
NTAPI
ScanTest(
    VOID
)
{
    PVOID Result = NULL;
    CHAR Sig[] = "08 00 0d ?? ?? 46 24-8b 7b 10";
	
    CHAR Data[] = {
        0x55, 0x8b, 0xec, 0x83, 0xe4, 0xf8, 0x51, 0x57, 0x8b, 0x7b, 0x10, 0x8b, 0x47, 0x10, 0x8b, 0x4f,
        0x0c, 0x68, 0xc0, 0x00, 0x00, 0x00, 0x6a, 0x00, 0x6a, 0x00, 0x50, 0xff, 0xd1, 0x83, 0xc4, 0x10,
        0x85, 0xc0, 0x75, 0x08, 0x6a, 0x04, 0x53, 0xe8, 0x64, 0x78, 0x00, 0x00, 0x81, 0x47, 0x44, 0xc0,
        0x00, 0x00, 0x00, 0x89, 0x46, 0x28, 0x89, 0x46, 0x14, 0x05, 0xa8, 0x00, 0x00, 0x00, 0xc7, 0x46,
        0x30, 0x08, 0x00, 0x00, 0x00, 0x89, 0x46, 0x24, 0x8b, 0x7b, 0x10, 0x8b, 0x57, 0x10, 0x8b, 0x47,
        0x0c, 0x68, 0xd0, 0x02, 0x00, 0x00, 0x6a, 0x00, 0x6a, 0x00, 0x52, 0xff, 0xd0, 0x83, 0xc4, 0x10,
        0x85, 0xc0, 0x75, 0x08, 0x6a, 0x04, 0x53, 0xe8, 0x24, 0x78, 0x00, 0x00, 0x81, 0x47, 0x44, 0xd0,
        0x02, 0x00, 0x00, 0x8b, 0x56, 0x14, 0x89, 0x46, 0x08, 0x89, 0x46, 0x20, 0x8d, 0x88, 0x70, 0x02,
    };
	
    __debugbreak();

    Result = ScanBytes(
        Data, 
        Data + _countof(Data), 
        Sig);

    __debugbreak();
}
